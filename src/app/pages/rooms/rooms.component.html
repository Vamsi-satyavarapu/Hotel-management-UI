<section class="py-5" id="rooms">
  <div class="container">
    <div class="text-center mb-4">
      <h2 class="fw-bold text-dark">Available Rooms</h2>
      <p class="text-muted">Choose from a variety of comfortable and well-maintained rooms</p>

     <div class="btn-group mb-4" role="group">
  <button class="btn btn-primary me-2" [ngClass]="{ 'active-filter': selectedFilter === 'all' }" (click)="filterRooms('all')">All</button>
  <button class="btn btn-primary me-2" [ngClass]="{ 'active-filter': selectedFilter === 'single' }" (click)="filterRooms('single')">Single</button>
  <button class="btn btn-primary me-2" [ngClass]="{ 'active-filter': selectedFilter === 'double' }" (click)="filterRooms('double')">Double</button>
  <button class="btn btn-primary me-2" [ngClass]="{ 'active-filter': selectedFilter === 'family' }" (click)="filterRooms('family')">Family</button>
</div>

    </div>

    <div class="row g-4">
      <div class="col-md-4" *ngFor="let room of rooms" [hidden]="!isVisible(room)">
        <div class="card h-100 shadow" [ngClass]="{ 'occupied-room': room.status === 'Occupied', 'available-room': room.status === 'Available' }">
          <img [src]="room.image" class="card-img-top" [alt]="'Room ' + room.number">
          <div class="card-body">
            <h5 class="card-title">
              Room {{ room.number }}
              <span class="badge ms-2"
                    [ngClass]="{
                      'bg-secondary': room.type === 'single',
                      'bg-info text-white': room.type === 'double',
                      'bg-warning text-dark': room.type === 'family'
                    }">
                {{
                  room.type === 'single' ? 'Single Bed' :
                  room.type === 'double' ? 'Double Bed' : 'Family'
                }}
              </span>
            </h5>

            <p><strong>Capacity:</strong> {{ room.capacity }}</p>
            <p><strong>Amenities:</strong> {{ room.amenities }}</p>

            <span class="badge" [ngClass]="{ 'bg-success': room.status === 'Available', 'bg-danger': room.status === 'Occupied' }">
              {{ room.status }}
            </span>

            <div *ngIf="room.status === 'Occupied'" class="mt-2">
              <p class="mb-1"><strong>Name:</strong> {{ room.customerName }}</p>
              <p class="mb-2"><strong>Phone:</strong> {{ room.customerPhone }}</p>
            </div>

            <div class="mt-3">
              <button *ngIf="room.status === 'Available'" class="btn btn-success w-100" (click)="openPaymentModal(room, 'book')">Book Now</button>
              <button *ngIf="room.status === 'Occupied'" class="btn btn-danger w-100" (click)="openPaymentModal(room, 'vacate')">Vacate</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  

</section>

<!-- Payment Modal -->
<div class="modal fade" id="paymentModal" tabindex="-1" aria-labelledby="paymentModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-dark text-white">
        <h5 class="modal-title" id="paymentModalLabel">
          {{ paymentType === 'book' ? 'Book Room' : 'Vacate Room' }}
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <form>
          <!-- Common Field -->
          <div class="mb-3">
            <label>Room Number</label>
            <input type="text" class="form-control" [value]="selectedRoom?.number" readonly />
          </div>

          <!-- BOOKING Section -->
          <div *ngIf="paymentType === 'book'">
            <div class="mb-3">
              <label for="name">Name</label>
              <input id="name" [(ngModel)]="customerName" name="name" type="text" class="form-control" placeholder="Enter name" />
            </div>
            <div class="mb-3">
              <label for="phone">Phone Number</label>
              <input id="phone" [(ngModel)]="customerPhone" name="phone" type="text" class="form-control" placeholder="Enter phone number" />
            </div>
            <div class="mb-3">
              <label>From Date</label>
              <input type="date" class="form-control" [(ngModel)]="fromDate" name="fromDate" />
            </div>
            <div class="mb-3">
              <label>Payment Mode</label>
              <select class="form-select" [(ngModel)]="paymentMode" name="paymentMode">
                <option value="Cash">Cash</option>
                <option value="UPI">UPI</option>
                <option value="UPI">Card</option>
              </select>
            </div>
            <p>Advance Payment: ₹{{ paymentAmount }}</p>
          </div>

          <!-- VACATING Section -->
          <div *ngIf="paymentType === 'vacate'">
            <div class="mb-3">
              <label>Name</label>
              <input type="text" class="form-control" [value]="customerName" readonly />
            </div>
            <div class="mb-3">
              <label>Phone Number</label>
              <input type="text" class="form-control" [value]="customerPhone" readonly />
            </div>
            <div class="mb-3">
              <label>From Date</label>
              <input type="date" class="form-control" [(ngModel)]="fromDate" name="fromDate" readonly />
            </div>
            <div class="mb-3">
              <label>To Date</label>
              <input type="date" class="form-control" [(ngModel)]="toDate" name="toDate" (change)="calculateStayDays()" />
            </div>
            <p>Stayed: {{ totalDays }} day(s)</p>
            <p>Total: ₹{{ totalDays * getRentPerDay(selectedRoom?.type || '') }}</p>
            <p>Advance Paid: ₹{{ getAdvanceAmount(selectedRoom?.type || '') }}</p>
            <p><strong>Amount Due: ₹{{ paymentAmount }}</strong></p>
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button class="btn btn-primary" (click)="makePayment()">Pay ₹{{ paymentAmount }}</button>
        <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>
